# 데이터 시각화

### 산점도(산포도) : scatter \> 데이터 분포 보기

```{r}
y <- c(1,1,2,2,3,3,4,4,5,5)
plot(y)
```

```{r}
x <- 1:10
y <- 1:10
plot(x,y)
```

```{r}
plot(y ~ x)
```

차트는 x, y축 데이터 범위 먼저 봐야 한다. 데이터 범위가 같아야 한다.

```{r}
plot(x, y,
     #x축에 limitation 주기 
     xlim = c(0, 11),
     ylim = c(0, 11)
     )
```

```{r}
seoul <- read.csv("./Data/newSeoul2019.csv")
head(seoul)
str(seoul)

```

### 서울시 교통사고 데이터로 발생건수와 부상자수의 산포도 구하기

단, 발생건수가 150이하이면 빨간색으로, 초과이면 파란색으로 구분하기

```{r}
par(family="AppleGothic")
plot(
  seoul$발생건수,seoul$부상자수,
  col = ifelse(seoul$발생건수<=150,"red","blue"),
  main = "서울 교통사고 발생건수",
  xlim = c(0, 500),
  ylim = c(0, 500)
)
```

### 자치구별 부상자수의 max값과 min값에 빨강, 파랑 그 외에는 검정

```{r}
seoul.agg <- aggregate(발생건수 ~ 자치구명, seoul, max)
seoul.reg <- unique(seoul$자치구명)
plot(seoul.reg, seoul$부상자수,
     col = ifelse(aggregate(발생건수 ~ 자치구명, seoul, max), 'red', 'black')
     
     )
```

```{r}
y <- c(1,3,2,4,8,5,7,6,9)
plot(y,
     #시계열
     main = "Simple Time Series",
     xlim = c(min(y) - 1, max(y) + 1),
     ylim = c(min(y) - 1, max(y) + 1)
     )
```

# 다양한 그래프 그래프

추세를 보는 방법

### 꺽은선 그래프

```{r}
y <- c(1,3,2,4,8,5,7,6,9)
plot(y,
     #시계열
     main = "Simple Time Series",
     xlim = c(min(y) - 1, max(y) + 1),
     ylim = c(min(y) - 1, max(y) + 1),
     #point
      #type = "p"
     #line
     type="l"
     )
```

### 점과 꺽은선 그래프

```{r}
y <- c(1,3,2,4,8,5,7,6,9)
plot(y,
     #시계열
     main = "Simple Time Series",
     xlim = c(min(y) - 1, max(y) + 1),
     ylim = c(min(y) - 1, max(y) + 1),
     #같이 보기
     type="b"
     )
```

### 점이 빠진 꺽은선 그래프

```{r}
y <- c(1,3,2,4,8,5,7,6,9)
plot(y,
     #시계열
     main = "Simple Time Series",
     xlim = c(min(y) - 1, max(y) + 1),
     ylim = c(min(y) - 1, max(y) + 1),
    
     type="c"
     )
```

### 점과 꺽은선 그래프를 중첩한 그래프

```{r}
y <- c(1,3,2,4,8,5,7,6,9)
plot(y,
     #시계열
     main = "Simple Time Series",
     xlim = c(min(y) - 1, max(y) + 1),
     ylim = c(min(y) - 1, max(y) + 1),
     #같이 보기
     type="o"
     )
```

### 수직선 그래프(크기를 알 수 있다.)

```{r}
y <- c(1,3,2,4,8,5,7,6,9)
plot(y,
     #시계열
     main = "Simple Time Series",
     xlim = c(min(y) - 1, max(y) + 1),
     ylim = c(min(y) - 1, max(y) + 1),
     #같이 보기
     type="h"
     )
```

### 왼쪽 값을 기초로 한 계단 모양 그래프

```{r}
y <- c(1,3,2,4,8,5,7,6,9)
plot(y,
     #시계열
     main = "Simple Time Series",
     xlim = c(min(y) - 1, max(y) + 1),
     ylim = c(min(y) - 1, max(y) + 1),
     #같이 보기
     type="s"
     )
```

### 오른쪽 값을 기초로한 계단 모양 그래프

```{r}
y <- c(1,3,2,4,8,5,7,6,9)
plot(y,
     #시계열
     main = "Simple Time Series",
     xlim = c(min(y) - 1, max(y) + 1),
     ylim = c(min(y) - 1, max(y) + 1),
     #같이 보기
     type="S"
     )

```

# Line Type

```{r}
y <- c(1,3,2,4,8,5,7,6,9)
plot(y,
     #시계열
     main = "Simple Time Series",
     xlim = c(min(y) - 1, max(y) + 1),
     ylim = c(min(y) - 1, max(y) + 1),
     #같이 보기
     type="S",
     #1~6 숫자 별로 다른 타입의 선 타입이 있다.
     lty = 4
     )
```

# Plotting Symbol

```{r}
y <- c(1,3,2,4,8,5,7,6,9)
plot(y,
     #시계열
     main = "Simple Time Series",
     xlim = c(min(y) - 1, max(y) + 1),
     ylim = c(min(y) - 1, max(y) + 1),
     pch = 0,
     col = "red"
  
     )
```

y의 값이 0.5보다 크면 컬러 red, pch=1, 아니면 color=blue, pch=18

```{r}
x <- runif(100)
y <- runif(100)

plot(
      x,y,
      col = ifelse(y>0.5, 'red', 'blue'),
      pch = ifelse(y>0.5, 1, 18),
      main = "example",
   
     )
```

# 선 그래프

```{r}
abc <- c(260, 300, 250, 280, 310)
abc
def <- c(180, 200, 210, 190, 170)
ghi <- c(210, 250, 260, 210, 270)
```

```{r}
par(family='AppleGothic')
plot(abc,
     type = 'o',
     col = "red",
     ylim = c(0, 400),
     #x, y축 프레임 없애기
     axes = F,
     #x, y축 라벨 없애기
     ann = F,
     )
#1 = x축 
axis(
      1, 
     #그래프 각 축 번호에 맞게 
     at = 1:5,
     lab = c('서울', '대전', '대구', '광주', '원주'),
     cex.axis = 0.5
     )
#2=y축
axis(2,
     ylim = c(0,400),
     cex.axis = 0.5
     )
title(main = '과일 판매량', col.main='red')
title(xlab = '지역', col.lab = 'blue')
title(ylab = '판매량', col.lab = 'green')

lines(def,
      type='o',
      pch=22,
      col='green',
      lty=2
      )
lines(ghi,
      type='o',
      pch=22,
      col='blue',
      lty=2
      )

#범례
legend(
  #표시할 좌표 위치 
  4, 100,
  c("야구장", "축구장", "해변가"),
  col=c('red', 'green', 'blue'),
  #pch default = 21
  pch = c(21, 22, 22),
  lty = c(1,2,2),
  #범례가 그래프를 가리면 안됨 그래서 사이즈 조정해야 됨(default = 1)
  cex = 0.7,
 
)
```

# 막대 그래프

```{r}
x <- 1:6
barplot(x,
        main = "1~6",
        xlab = "Sales",
        ylab = "Amounts",
        names = c('A', 'B', 'C', 'D', 'E', 'F'),
        col = c('red', rep('blue', 5))
        )

```

막대 테이블이 아는 데이터타입

-벡터, 테이블, matrix

```{r}
x
```

```{r}
par(family='AppleGothic')
#1~6까지의 행 열
x <- matrix(1:6, 3,2)
x

barplot(x,
        #데이터가 축을 넘어가면 안됨(조정해주기)
        ylim = c(0,20),
        )
rownames(x) <- c('A', 'B', 'C')
barplot(x,
        #데이터가 축을 넘어가면 안됨(조정해주기)
        ylim = c(0,10),
        beside = T,
        names = c("Korea", 'America'),
        main = '수출량',
        xlab = '국가',
        ylab = '빈도수',
        col = c('red', 'green', 'blue'),
        #x에 이름을 줘야됨(위에 rownames준 것 확인), 데이터 가리지 않게!! 여기서는 y축 크기 조정해줌
        legend.text = T
        )
```

\*같은 색깔: 같은 행

```{r}
barplot(abc,
        main="Baseball Sales",
        xlab = 'Season',
        ylab = 'Sales',
        names = c('Jan', 'Feb', 'Mar', 'Apr', 'May'),
        col = c('red',rep('blue', length(abc)-1)),
        density = c(10, 30, 50, 30, 10),
        border = c('red',rep('blue', length(abc)-1)),
        )
```

# 기존 데이터 바꿔주기(학력별 점수 차이)

1.  데이터 전체 파악

```{r}
data <- read.csv("./Data/education.csv", head = F)
head(data)
```

```{r}
str(data)
```

V1: 남, 여

V2: 점수

V3: 국,영,수

V4: 초, 중, 고, 대, 원

2.  NA값 확인

```{r}
sum(is.na(data))
```

3.  각 데이터별 행 종류 확인

```{r}
table(data$V1)
```

4.  data를 factor로 바꿔주기

```{r}
data$V1 <- factor(data$V1, levels = 1:2, labels = c('남', '여'))
data$V3 <- factor(data$V3, levels = 1:3, labels = c('국어', '영어', '수학'))
data$V4 <- factor(data$V4, levels = 1:5, labels = c('초', '중', '고', '대', '원'))
```

```{r}
head(data)
```

```{r}
str(data)
```

```{r}
colnames(data) <- c("성별", "점수", "과목", "학력")
head(data)
```

```{r}
table(data$점수)
```

## 점수별 빈도수를 막대그래프로 표현 하세요

```{r}
par(family='AppleGothic')

barplot(table(data$점수),
        main = "점수별 빈도수",
       
        xlab = "과목",
        ylab = "점수",
        )
```

성별 학력별 빈도수를 표현

```{r}
table(data$성별)
table(data$학력)
table(data$성별, data$학력)
table(data$학력, data$성별)
```

```{r}
par(family='AppleGothic')
barplot(
  table(data$성별, data$학력),
  beside=T,
  ylim = c(0,9)
)
```

## 년도별 분기별 비교 막대 그래프

```{r}
chart_data <- c(305, 450, 320, 460, 330, 480, 380, 520)
names(chart_data) <- c('2017 1분기', '2018 1분기',
                       '2017 2분기', '2018 2분기',
                       '2017 3분기', '2018 3분기',
                       '2017 4분기', '2018 4분기'
                       )
chart_data
```

```{r}
par(family='AppleGothic')
barplot(chart_data,
        main='2017년도 2018년도 분기별 매출 현황 비교',
        ylim = c(0,600),
        col=rainbow(length(chart_data)),
        xlab='년도별 분기현황',
        ylab='매출액(단위:만원)'
        )
```

```{r}
par(family='AppleGothic')
barplot(chart_data,
        main='2017년도 2018년도 분기별 매출 현황 비교',
        xlim = c(0,600),
        col=rainbow(length(chart_data)),
        ylab='년도별 분기현황',
        xlab='매출액(단위:만원)',
        horiz = T,
        cex.names = 0.3,
        #간격
        space = 0.5
        )
```

```{r}
par(family='AppleGothic')
barplot(chart_data,
        main='2017년도 2018년도 분기별 매출 현황 비교',
        xlim = c(0,600),
        col = rep(c('red','blue')),
        ylab='년도별 분기현황',
        xlab='매출액(단위:만원)',
        horiz = T,
        cex.names = 0.3,
        #간격
        space = 0.5
        
```

```{r}
par(family='AppleGothic')
barplot(chart_data,
        main='2017년도 2018년도 분기별 매출 현황 비교',
        xlim = c(0,600),
        col = rep(c('red','blue')),
        ylab='년도별 분기현황',
        xlab='매출액(단위:만원)',
        horiz = T,
        cex.names = 0.3,
        #간격
        space = 0.5
        )
```

# 1940년 미국 버지니아주 하위계층 사망 비율

```{r}
VADeaths
```

```{r}
str(as.data.frame(VADeaths))
```

```{r}
par(family='AppleGothic')
barplot(VADeaths,
        beside = T,
        col = rainbow(5),
        ylim = c(0,80),
        
        )

#범례
legend(
  #표시할 좌표 위치 
  7, 80,
  rownames(VADeaths),
  fill = rainbow(5),
  cex = 0.7
 
)
```

# 파이차트

```{r}
T_Sales <- c(210, 110, 400, 550, 600, 130)

par(family='AppleGothic')

week <- c('월','화','수','목','금','토','일')
ratio <- T_Sales / sum(T_Sales) * 100
label <- paste(week, "\n", ratio, '%')

pie(T_Sales,
    main = '영업 실적 파이 차트',
    col = rainbow(length(T_Sales)),
    labels = label,
    
    )
```

# 3D Pie Chart

```{r}
library(plotrix)
```

```{r}
T_Sales <- c(210, 110, 400, 550, 600, 130)

par(family='AppleGothic')

week <- c('월','화','수','목','금','토','일')
ratio <- T_Sales / sum(T_Sales) * 100
label <- paste(week, "\n", ratio, '%')

pie3D(T_Sales,
    main = '영업 실적 파이 차트',
    col = rainbow(length(T_Sales)),
    labels = label,
    #라벨 크기
    labelcex = 0.5,
    #파이를 쪼개기
    explode = 0.08,
    #그래프 각도 
    theta=pi/5,
    #그림자 
    shade=0.5
    )
```
